<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="utf-8" />
  <title></title>
  <script type="text/javascript">

    let welcome;

    function injectScript(src) {
      return new Promise((resolve, reject) => {
        const script = document.createElement('script');
        script.async = true;
        script.src = src;
        script.addEventListener('load', resolve);
        script.addEventListener('error', () => reject('Error loading script.'));
        script.addEventListener('abort', () => reject('Script loading aborted.'));
        document.head.appendChild(script);
      });
    }

    injectScript('./lib/dev/custom-elements-es5-adapter.js')
      .then(() => {
        console.log('custom-elements-es5-adapter loaded!');
        injectScript('./lib/dev/webcomponents-loader.js')
          .then(() => {
            console.log('Webcomponents loaded!');
            injectScript('./lib/dev/codered_nps_widget.js')
              .then(() => {
                console.log('Script loaded!');
                welcome = new (codered_nps_widget.Welcome)('Paul');
              }).catch(error => {
                console.log(error);
              });
          }).catch(error => {
            console.log(error);
          });
      }).catch(error => {
        console.log(error);
      });


    function clickAndChangeName() {
      welcome.ClickMeButton();
      welcome.usersName = welcome.usersName + '.';
    };
  </script>
</head>
<body>
  <div id="divMsg"></div>
  <br />
  <button type="button" class="btn btn-primary btn-md" onclick="clickAndChangeName()">
    Show Message
  </button>
  <nps-widget mood="happy"></nps-widget>
</body>
</html>
